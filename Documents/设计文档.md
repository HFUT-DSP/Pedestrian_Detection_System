# 视频监控系统软件设计文档

**版本**：V1.0  
**日期**：2024-06-25  

**合肥工业大学计算机与信息学院  
DSP实验室**

---

## 1. 变更历史

| 编号 | 版本 | 修改内容 | 修改人 | 日期 |
| ---- | ---- | -------- | ------ | ---- |
|      |      |          |        |      |
|      |      |          |        |      |
|      |      |          |        |      |
|      |      |          |        |      |
|      |      |          |        |      |
|      |      |          |        |      |
|      |      |          |        |      |
|      |      |          |        |      |
|      |      |          |        |      |
|      |      |          |        |      |
|      |      |          |        |      |
|      |      |          |        |      |

---

## 2. 前言

### 2.1 目的

### 2.2 范围

### 2.3 文档约定

---

## 3. 设计目标

### 3.1 需求背景

### 3.2 整体目标

### 3.3 分解目标

### 3.4 平台接入

### 3.5 视频分析处理

### 3.6 存储及告警上报

### 3.7 自服务门户

### 3.8 能力开放

---

## 4. 总体架构设计

### 4.1 软件架构设计

---

## 5. 系统功能设计

### 5.1 用户登录

| 功能描述 | 具有用户身份验证、记住登录状态、忘记密码、以及用户注销功能。 |
| -------- | ------------------------------------------------------------ |
| 涉及模块 | 用户管理                                                     |
| 权限配置 | 所有用户                                                     |

#### 5.1.1 功能说明

1. 用户登录：
   1. 用户输入用户名和密码进行身份验证。
   2. 验证成功后，允许用户访问系统。
2. 记住我：
   1. 提供“记住我”选项，用户可以选择记住登录状态，方便下次自动登录。
3. 忘记密码：
   1. 提供忘记密码链接，用户可以通过邮箱重置密码。
4. 注销：
   1. 提供注销按钮，用户点击后退出登录状态。

#### 5.1.2 界面说明

1. 界面按钮：
   1. 登录：提交用户名和密码进行登录。
   2. 记住我：选择是否在本地保存登录信息，方便下次自动登录。
   3. 忘记密码：点击后进入密码重置流程。
   4. 注销：点击后注销当前用户。
2. 表单展现：
   1. 登录表单：包含用户名和密码输入框。
   2. 密码重置表单：包含用户名或邮箱输入框，用于发送密码重置链接。
3. 提示信息：
   1. 登录失败提示：当用户名或密码错误时，显示错误提示信息。
   2. 密码重置成功提示：当密码重置链接发送成功时，显示提示信息。

#### 5.1.3 Java接口

```java
public interface UserAuthentication {
    boolean login(String username, String password);
    void logout();
    boolean resetPassword(String emailOrUsername);
    boolean validateResetToken(String token);
    boolean changePassword(String token, String newPassword);
}
```

#### 5.1.4 数据库表设计

**Users**:

- id (PK INT AUTO_INCREMENT)
- username (VARCHAR(255))
- password (VARCHAR(255)) // 存储加密后的密码
- email (VARCHAR(255))
- created_at (DATETIME)
- updated_at (DATETIME)

**Password_reset_tokens**:

- id (PK INT AUTO_INCREMENT)
- user_id (FK INT)
- token (VARCHAR(255))
- expires_at (DATETIME)
- created_at (DATETIME)

### 5.2 用户列表维护

| 功能描述 | 具有增加、删除、刷新用户列表的功能 |
| -------- | ---------------------------------- |
| 涉及模块 | 用户管理                           |
| 权限配置 | 操作员、系统管理员                 |

#### 5.2.1 功能说明

1. 增加用户列表功能：可以通过输入用户名、密码、邮箱等信息，添加新的用户到系统。新用户添加后会获取用户ID、用户名、角色等信息。
2. 删除用户列表功能：删除已添加的用户及其相关信息。确保在删除前会有确认提示，以防误删。
3. 更新用户列表功能：当用户信息（如邮箱、角色）发生改变时，可以通过更新同步信息。

#### 5.2.2 界面说明

1. 界面按钮：
   1. 增加用户：添加新的用户到系统。
   2. 删除用户：删除选中的用户。
   3. 刷新用户列表：同步系统中用户的最新信息。
2. 列表展现：
   1. 展现所有用户列表，包括用户名、邮箱、角色、创建时间等信息。
   2. 用户列表可以分页显示。
3. 排序方式：
   1. 默认排序方式根据用户名首字母升序排列。
   2. 其他排序方式可点击相应字段后面的排序按钮，进行对应字段首字母的升序或降序排列。

### 5.3 角色管理

| 功能描述 | 具有增加、删除、更新角色的功能，并能为角色配置权限。 |
| -------- | ---------------------------------------------------- |
| 涉及模块 | 权限管理                                             |
| 权限配置 | 系统管理员                                           |

#### 5.3.1 功能说明

1. 增加角色功能：可以通过输入角色名称和描述，添加新的角色到系统。为新角色配置相应的权限。
2. 删除角色功能：删除已添加的角色。确保在删除前会有确认提示，以防误删。
3. 更新角色功能：当角色信息（如名称、描述、权限）发生改变时，可以通过更新同步信息。
4. 角色可分为：系统管理员（System Administrator）、管理员（Security Administrator）、操作员（Operator）。

#### 5.3.2 界面说明

1. 界面按钮：
   1. 增加角色：添加新的角色到系统。
   2. 删除角色：删除选中的角色。
   3. 更新角色：更新选中角色的信息。
2. 列表展现：
   1. 展现所有角色列表，包括角色名称、描述、创建时间等信息。
   2. 角色列表可以分页显示。
3. 排序方式：
   1. 默认排序方式根据角色名称首字母升序排列。
   2. 其他排序方式可点击相应字段后面的排序按钮，进行对应字段首字母的升序或降序排列。

### 5.4 系统设置

| 功能描述 | 具有配置系统参数、进行备份和恢复、管理时间和日期设置的功能。 |
| -------- | ------------------------------------------------------------ |
| 涉及模块 | 系统管理                                                     |
| 权限配置 | 系统管理员                                                   |

#### 5.4.1 功能说明

1. 配置系统参数：
   1. 配置系统的基本参数，包括系统名称、语言设置、时区等。
   2. 配置与其他系统的集成参数，如API密钥、URL等。
2. 备份和恢复：
   1. 定期备份系统数据，确保数据安全。
   2. 在需要时从备份中恢复系统数据。
3. 管理时间和日期设置：
   1. 配置系统时间和日期格式。
   2. 同步系统时间与标准时间服务器。

#### 5.4.2 界面说明

1. 界面按钮：
   1. 配置参数：设置和保存系统参数。
   2. 备份系统：手动备份系统数据。
   3. 恢复系统：从备份中恢复系统数据。
   4. 设置时间：配置系统时间和日期格式，进行时间同步。
2. 列表展现：
   1. 展现当前系统参数的列表，包括参数名称、当前值、描述等信息。
   2. 展现备份历史记录，包括备份时间、备份名称、备份状态等。
3. 排序方式：
   1. 默认排序方式根据参数名称首字母升序排列。
   2. 其他排序方式可点击相应字段后面的排序按钮，进行对应字段首字母的升序或降序排列。

### 5.5 摄像头列表维护

| 功能描述 | 具有增加、删除、刷新账号下摄像头列表功能 |
| -------- | ---------------------------------------- |
| 涉及模块 | 系统管理                                 |
| 权限配置 | 操作员、系统管理员                       |

#### 5.5.1 功能说明

1. 增加摄像头：
    1. 输入摄像头名称、IP地址、端口等信息，将新的摄像头添加到系统。
    2. 为摄像头分配唯一的ID。
2. 删除摄像头：
    1. 删除系统中已有的摄像头。
    2. 删除前会有确认提示，以防误删。
3. 刷新摄像头列表：
    1. 从数据库中重新加载摄像头列表，确保显示最新的信息。

#### 5.5.2 界面说明

1. 界面按钮：
    1. 增加摄像头：添加新的摄像头到系统。
    2. 删除摄像头：删除选中的摄像头。
    3. 刷新列表：同步系统中摄像头的最新信息。
2. 列表展现：
    1. 展现所有摄像头的列表，包括摄像头名称、IP地址、端口、状态等信息。
    2. 摄像头列表可以分页显示。
3. 排序方式：
    1. 默认排序方式根据摄像头名称首字母升序排列。
    2. 其他排序方式可点击相应字段后面的排序按钮，进行对应字段首字母的升序或降序排列。










### 5.6 模型管理

| 功能描述 | 具有增加、删除、刷新已经训练好的模型功能。模型类型包括行人重识别模型、目标检测模型、目标跟踪模型等。 |
| -------- | ------------------------------------------------ |
| 涉及模块 | 模型管理模块                                         |
| 权限配置 | 操作员、系统管理员                               |

#### 5.6.1 功能说明

1. 增加模型功能：允许用户上传已经训练好的模型，支持多种模型格式（如ONNX, TensorFlow(Checkpoint), PyTorch(pt或pth)等）。上传后，系统将验证模型的合法性和兼容性，并获取模型的ID、名称、类型、版本等信息。
2. 删除模型功能：用户可以删除已上传的模型。
3. 更新模型功能：用户可以更新已有的模型，系统将重新验证并替换旧模型。
   

#### 5.6.2 界面说明

1. 界面按钮：增加模型、删除模型、刷新模型列表。
2. 列表展现：展示已上传模型的列表，主要包括模型名称、模型类型（行人重识别、目标检测、目标跟踪）、上传时间、模型状态等信息。
3. 排序方式：默认排序方式根据模型名称的首字母升序排列。其他排序方式可点击相应字段后面的排序按钮，进行对应字段首字母的升序或降序排列。















### 5.7 告警管理

| 功能描述 | 具有创建、删除、修改和执行任务的功能，能够调度和管理系统中的定时任务。 |
| -------- | ------------------------------------------------ |
| 涉及模块 | 任务管理                                         |
| 权限配置 | 操作员、系统管理员                               |

#### 5.7.1 功能说明

1. 创建任务：
    1. 用户可以创建新的定时任务，设置任务名称、执行时间、任务类型等参数。
    2. 新任务可以立即生效并按照设定的时间执行。
2. 删除任务：
    1. 用户可以删除指定的定时任务。
    2. 被删除的任务将不再被执行。
3. 修改任务：
    1. 用户可以修改已有任务的参数，例如执行时间、任务类型等。
    2. 修改后的任务将按照新的参数执行。
4. 执行任务：
    1. 用户可以手动触发任务执行。
    2. 提供立即执行功能，允许用户在不等待定时的情况下立即执行任务。
   
#### 5.7.2 界面说明
1. 界面按钮：
    1. 创建任务：打开新增任务表单，输入任务信息并提交。
    2. 删除任务：选中一个或多个任务，点击删除按钮，确认后删除任务。
    3. 修改任务：选中一个任务，点击修改按钮，编辑任务信息并提交。
    4. 执行任务：选中一个任务，点击执行按钮，立即执行任务。
2. 列表展现：
    1. 显示任务列表，包括任务名称、执行时间、任务类型、状态等信息。
    2. 支持根据任务名称、执行时间等字段排序和搜索。


















### 5.8 AI视频分析任务

| 功能描述 | 行人重识别界面提供了配置行人重识别算法、查看行人识别结果和管理识别任务的功能。 |
| -------- | ------------------------------------------------ |
| 涉及模块 | 算法管理                                         |
| 权限配置 | 操作员、系统管理员                               |

#### 5.8.1 行人重识别界面功能

● 功能说明 
  1. 算法配置  
    1.1 设置和调整行人重识别算法的参数。  
    1.2 启动和停止行人重识别算法。 
  2. 行人识别结果查看  
    2.1 实时显示识别到的行人及其匹配信息。  
    2.2 查看行人历史记录和识别结果。  
    2.3 显示行人的匹配图像、时间、位置等详细信息。  
  3. 识别任务管理  
    3.1 创建新的识别任务，包括选择监控摄像头和设置识别条件。  
    3.2 查看和管理当前运行的识别任务。  
    3.3 删除或编辑识别任务。  
  4. 识别记录导出   
    4.1 将识别记录导出为CSV或Excel文件，方便后续分析。 
  5. 日志和报表：  
    5.1 查看行人重识别的日志记录。  
    5.2 生成和查看识别统计报表。 

● 界面说明
  1. 界面按钮  
    1.1 配置算法：打开算法配置窗口，设置和保存算法参数。  
    1.2 启动算法：启动行人重识别算法。  
    1.3 停止算法：停止行人重识别算法。  
    1.4 新建任务：创建新的识别任务。  
    1.5 删除任务：删除选中的识别任务。  
    1.6 导出记录：将识别记录导出为文件。  
    1.7 生成报表：生成识别统计报表。  
  2. 列表展现：  
    2.1 识别结果列表：展示所有识别到的行人，包括识别时间、位置、匹配图像、相似度等信息。  
    2.2 任务列表：展示当前所有识别任务，包括任务名称、监控摄像头、状态等信息。  
  3. 图表展示：  
    3.1 识别结果的统计图表，如识别频率、识别准确率等。  
  4. 排序和过滤：  
    4.1 识别结果和任务列表可以根据时间、相似度、位置等字段进行排序和过滤。  















### 5.9 告警管理

| 功能描述 | 具有设置告警规则、查看告警记录、处理告警事件功能 |
| -------- | ------------------------------------------------ |
| 涉及模块 | 告警管理                                         |
| 权限配置 | 操作员、系统管理员                               |

#### 5.9.1 功能说明

1. 设置告警规则：
    1. 定义告警触发条件，如视频信号丢失、移动检测等。
    2. 设置告警级别，如高、中、低。
    3. 配置告警通知方式，如邮件、短信等。
2. 查看告警记录：
    1. 展示所有告警记录，包括告警时间、告警类型、处理状态等信息。
2. 处理告警事件：
    1. 对告警事件进行确认、处理和关闭操作。
    2. 记录处理过程和结果。

#### 5.9.2 界面说明

1. 界面按钮：
    1. 设置规则：配置告警触发条件和通知方式。
    2. 查看记录：查看历史告警记录。
    3. 处理告警：确认和处理告警事件。
2. 列表展现：
    1. 展示所有告警记录，包括告警时间、类型、状态等。
    2. 告警记录可以分页显示。
3. 排序方式：
    1. 默认排序方式根据告警时间降序排列。
    2. 其他排序方式可点击相应字段后面的排序按钮，进行对应字段的升序或降序排列。

### 5.10 视频回放

| 功能描述 | 具有查看历史视频、选择回放时间段、控制回放速度的功能 |
| -------- | ---------------------------------------------------- |
| 涉及模块 | 视频管理                                             |
| 权限配置 | 操作员、系统管理员                                   |

#### 5.10.1 功能说明

1. 查看历史视频：
    1. 选择摄像头和时间段，查看对应的历史视频。
2. 选择回放时间段：
    1. 自定义选择回放的开始和结束时间。
3. 控制回放速度：
    1. 支持调整回放速度，如快进、慢放等。

#### 5.10.2 界面说明

1. 界面按钮：
    1. 播放：开始播放选定的历史视频。
    2. 暂停：暂停当前播放的视频。
    3. 快进：加快视频播放速度。
    4. 慢放：减慢视频播放速度。
2. 时间选择：
    1. 提供日期和时间选择器，选择视频回放的时间段。
3. 视频控制：
    1. 提供播放进度条，显示当前播放位置。

### 5.11 系统日志

| 功能描述 | 具有记录系统操作日志、查询和导出日志功能 |
| -------- | ---------------------------------------- |
| 涉及模块 | 日志管理                                 |
| 权限配置 | 系统管理员                               |

#### 5.11.1 功能说明

1. 记录系统操作日志：
    1. 自动记录系统的各种操作日志，如用户登录、数据修改等。
2. 查询日志：
    1. 支持根据时间、用户、操作类型等条件查询日志。
3. 导出日志：
    1. 支持将日志导出为CSV、Excel等格式，方便离线分析。

#### 5.11.2 界面说明

1. 界面按钮：
    1. 查询日志：根据条件查询系统日志。
    2. 导出日志：将查询结果导出为指定格式。
2. 列表展现：
    1. 展示查询到的日志记录，包括时间、用户、操作类型等信息。
    2. 日志记录可以分页显示。
3. 排序方式：
    1. 默认排序方式根据日志时间降序排列。
    2. 其他排序方式可点击相应字段后面的排序按钮，进行对应字段的升序或降序排列。

---